var t=Object.defineProperty,e=Object.defineProperties,i=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(e,i,a)=>i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[i]=a,r=(t,e)=>{for(var i in e||(e={}))s.call(e,i)&&o(t,i,e[i]);if(a)for(var i of a(e))n.call(e,i)&&o(t,i,e[i]);return t};const h=document.getElementById("gameCanvas"),l={FPS:60,LIVES:3,CANVAS:h,CTX:h.getContext("2d")};class d{constructor(){this.scenes={},this.currentSceneName,this.startTime,this.countCurrentScenePerformed}isValidSceneKey(t){return this.scenes.hasOwnProperty(t)}init(){this.scenes={},this.startTime=void 0,this.countCurrentScenePerformed=void 0}add(t,e){this.scenes[t]=e}use(t){console.log("use scene: ",t),this.isValidSceneKey(t)&&(this.currentSceneName=t,this.startTime=Date.now())}update(){this.currentSceneName&&this.isValidSceneKey(this.currentSceneName)&&this.scenes[this.currentSceneName]()}}const c=()=>{l.CTX.fillStyle="black",l.CTX.fillRect(0,0,l.CANVAS.width,l.CANVAS.height)};const m=new Image;m.src="data:image/png;base64,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";const g=.2,u=100,p=100,y=10,A=(t,e,i,a)=>Math.sqrt(Math.pow(i-t,2)+Math.pow(a-e,2)),S=.1,C=.3,M=3,T=30,x=5,v=.2,X=.2;class b{constructor(){this.handleEdgeOfScreen=()=>{this.data.x<0-this.data.r?this.data.x=l.CANVAS.width+this.data.r:this.data.x>l.CANVAS.width+this.data.r?this.data.x=0-this.data.r:this.data.x=this.data.x,this.data.y<0-this.data.r?this.data.y=l.CANVAS.height+this.data.r:this.data.y>l.CANVAS.height+this.data.r?this.data.y=0-this.data.r:this.data.y=this.data.y},this.data={x:0,y:0,vx:0,vy:0,r:0,a:0}}setData(t){this.data=r(r({},this.data),t)}get getData(){return this.data}}class f{constructor(t,e,i){this.enemyType="enemy",this.vert=0,this.offs=[],this.level=t,this.position=new b,this.init(e,i)}init(t,e){let i,a,s;if(e)i=e.x,a=e.y,s=e.size;else{if(!1===t)return;do{i=Math.floor(Math.random()*l.CANVAS.width),a=Math.floor(Math.random()*l.CANVAS.height)}while(A(t.x,t.y,i,a)<2*u+t.r);s=Math.ceil(u/2)}const n=1+.5*this.level;this.position.setData({x:i,y:a,vx:Math.random()*p*n/l.FPS*(Math.random()<.5?1:-1),vy:Math.random()*p*n/l.FPS*(Math.random()<.5?1:-1),r:s,a:Math.random()*Math.PI*2}),this.vert=Math.floor(Math.random()*(y+1)+y/2),[...Array(this.vert)].map((t=>{this.offs.push(Math.random()*g*2+1-g)}))}draw(){var t,e,i;t=this.position.getData,e=this.vert,i=this.offs,l.CTX.lineWidth=T/20,l.CTX.strokeStyle="red",l.CTX.beginPath(),l.CTX.moveTo(t.x+t.r*i[0]*Math.cos(t.a),t.y+t.r*i[0]*Math.sin(t.a)),[...Array(e)].map(((a,s)=>{l.CTX.lineTo(t.x+t.r*i[s]*Math.cos(t.a+s*Math.PI*2/e),t.y+t.r*i[s]*Math.sin(t.a+s*Math.PI*2/e))})),l.CTX.closePath(),l.CTX.stroke()}updatePosition(){const t=this.position.getData;let e=t.x+t.vx,i=t.y+t.vy;this.position.setData({x:e,y:i}),this.position.handleEdgeOfScreen()}update(){this.draw(),this.updatePosition()}}class P{constructor(t,e,i){this.enemyType="trackingEnemy",this.level=t,this.vert=0,this.offs=[],this.position=new b,this.init(e,i)}init(t,e){let i,a,s;if(e)i=e.posX,a=e.posY,s=e.size;else{if(!1===t)return;do{i=Math.floor(Math.random()*l.CANVAS.width),a=Math.floor(Math.random()*l.CANVAS.height)}while(A(t.x,t.y,i,a)<2*u+t.r);s=Math.ceil(u/6)}const n=1+.5*this.level;this.position.setData({x:i,y:a,vx:Math.random()*p*n/l.FPS*(Math.random()<.5?1:-1),vy:Math.random()*p*n/l.FPS*(Math.random()<.5?1:-1),r:s,a:Math.random()*Math.PI*2}),this.vert=Math.floor(Math.random()*(y+1)+y/2),[...Array(this.vert)].map((t=>{this.offs.push(Math.random()*g*2+1-g)}))}draw(){var t,e,i;t=this.position.getData,e=this.vert,i=this.offs,l.CTX.lineWidth=T/20,l.CTX.strokeStyle="yellow",l.CTX.beginPath(),l.CTX.moveTo(t.x+t.r*i[0]*Math.cos(t.a),t.y+t.r*i[0]*Math.sin(t.a)),[...Array(e)].map(((a,s)=>{l.CTX.lineTo(t.x+t.r*i[s]*Math.cos(t.a+s*Math.PI*2/e),t.y+t.r*i[s]*Math.sin(t.a+s*Math.PI*2/e))})),l.CTX.closePath(),l.CTX.stroke()}updatePosition(t){if(!t)return;const e=this.position.getData,i=((t,e,i,a)=>Math.sqrt((t-i)**2+(e-a)**2))(t.x,t.y,e.x,e.y),[a,s]=[t.x-e.x,t.y-e.y],n=i/(2*p/l.FPS),o=a/n,r=s/n;let h=e.x+o,d=e.y+r;this.position.setData({x:h,y:d}),this.position.handleEdgeOfScreen()}update(t){this.draw(),this.updatePosition(t)}}const E=(t,e,i,a,s,n)=>Math.sqrt(Math.pow(a-t,2)+Math.pow(s-e,2))<i+n,k=(t,e,i)=>{const a=((t,e)=>{const i=e.r==Math.ceil(u/2),a=e.r==Math.ceil(u/4);let s=[];if(i){console.log("isBigEnemy");const i={x:e.x,y:e.y,size:Math.ceil(u/4)};s.push(new f(t,!1,i)),s.push(new f(t,!1,i))}else if(a){console.log("small");const i={x:e.x,y:e.y,size:Math.ceil(u/8)};s.push(new f(t,!1,i)),s.push(new f(t,!1,i))}return s})(t,e[i].position.getData),s=[...e];s.splice(i,1);return s.concat(a)},w=(t,e,i)=>{if("enemy"===e[i].enemyType)return k(t,e,i);{const t=[...e];return t.splice(i,1),[...t]}},V=(t,e,i)=>{c();const{player:a,enemies:s}=t.gameState;a.update(),s.forEach((t=>{t.update(a.position.getData)})),!t.isGameover()||a.isExploding()?((t=>{const{player:e,enemies:i,level:a}=t.gameState;if(!e||e.isBlink())return;const s=e.position.getData;i.forEach(((n,o)=>{const r=n.position.getData,h=E(s.x,s.y,s.r,r.x,r.y,r.r);if(h&&!e.isBlink()&&!e.isExploding()){console.log(h),t.debugMethod().isGod()||(e.die(),t.reduceLives());const s=w(a,i,o);t.updateEnemies(s)}t.isGameover()||e.laser.lasers.forEach((e=>{const s=e.position.getData;if(!E(s.x,s.y,s.r,r.x,r.y,r.r))return;e.die();const n=w(a,i,o);t.updateEnemies(n)}))}))})(t),t.isStageClear()&&t.sceneManager.use(i)):t.sceneManager.use(e)},D=t=>{c();const{player:e}=t.gameState;t.levelUp();const{enemies:i,level:a}=t.gameState;[...Array(a)].map((t=>{const s=new f(a,e.position.getData,!1);i.push(s)}))},B={title:t=>{c(),l.CTX.drawImage(m,0,0),t.sceneManager.use("title")},initGame:t=>{(t=>{const{player:e,enemies:i,level:a}=t.gameState;e.removeAction(),e.init(),e.addAction(),[...Array(a)].map((t=>{const s=new f(a,e.position.getData,!1);i.push(s)}));const s=new P(a,e.position.getData,!1);i.push(s),c()})(t),t.sceneManager.use("game")},game:t=>{V(t,"gameover","gameStageUp")},gameStageUp:t=>{D(t),t.sceneManager.use("game")},gameover:t=>{(t=>{c();const{player:e,enemies:i}=t.gameState;i.forEach((t=>{t.update(e.position.getData)}))})(t)},debugInitGame:t=>{(t=>{const{player:e,enemies:i,level:a}=t.gameState;e.removeAction(),e.init(),e.addAction(),document.removeEventListener("keydown",(e=>{"KeyK"===e.code&&t.debugMethod().killEnemy()})),document.addEventListener("keydown",(e=>{"KeyK"===e.code&&(console.log("K"),console.log(t.gameState.enemies),t.debugMethod().killAllEnemy())})),t.debugMethod().god(),[...Array(a)].map((t=>{const s=new f(a,e.position.getData,!1);i.push(s)}));const s=new P(a,e.position.getData,!1);i.push(s),c()})(t),t.sceneManager.use("debugGame")},debugGame:t=>{V(t,"gameover","debugGameStageUp")},debugGameStageUp:t=>{D(t),t.sceneManager.use("debugGame")}},U=.6,I=10,L=500;class F{constructor(t){this.position=new b,this.dist=0,this.explodeTime=0,this.dead=!1,this.init(t)}die(){this.dead=!0}isDead(){return this.dead}init(t){this.position.setData({x:t.x+4/3*t.r*Math.cos(t.a),y:t.y-4/3*t.r*Math.sin(t.a),vx:L*Math.cos(t.a)/l.FPS,vy:-L*Math.sin(t.a)/l.FPS,r:0,a:0}),this.dist=0,this.explodeTime=0,this.dead=!1}draw(){var t;t=this.position.getData,this.explodeTime>0?(l.CTX.fillStyle="orangered",l.CTX.beginPath(),l.CTX.arc(t.x,t.y,.75*t.r,0,2*Math.PI,!1),l.CTX.fill(),l.CTX.fillStyle="salmon",l.CTX.beginPath(),l.CTX.arc(t.x,t.y,.5*t.r,0,2*Math.PI,!1),l.CTX.fill(),l.CTX.fillStyle="pink",l.CTX.beginPath(),l.CTX.arc(t.x,t.y,.25*t.r,0,2*Math.PI,!1),l.CTX.fill()):(l.CTX.fillStyle="salmon",l.CTX.beginPath(),l.CTX.arc(t.x,t.y,T/15,0,2*Math.PI,!1),l.CTX.fill())}updatePosition(){const t=this.position.getData;if(this.dist>U*l.CANVAS.width)return void this.die();this.explodeTime>0||(t.x+=t.vx,t.y+=t.vy),this.dist+=Math.sqrt(Math.pow(t.vx,2)+Math.pow(t.vy,2)),this.position.handleEdgeOfScreen()}update(){this.draw(),this.updatePosition()}}class K{constructor(){this.disableCanShoot=()=>{this.canShoot=!1},this.canShoot=!0,this.shootTime=0,this.lasers=[]}enableCanShoot(){this.canShoot=!0}updateLasers(){this.lasers.forEach(((t,e)=>{t.isDead()?this.lasers.splice(e,1):t.update()}))}autoShootLaser(t){if(0<this.shootTime)this.shootTime--;else if(this.lasers.length<I){const e=new F(t);this.lasers.push(e),this.shootTime=Math.ceil(v*l.FPS)}}}class G{constructor(){this.thrust={x:0,y:0},this.isThrusting=!1}get currentStatus(){return this.thrust}enableThrusting(){this.isThrusting=!0}disableThrusting(){this.isThrusting=!1}add(t){this.thrust.x+=t.x,this.thrust.y+=t.y}update(t){let e={x:0,y:0};this.isThrusting?(e.x=this.thrust.x+=x*Math.cos(t)/l.FPS,e.y=this.thrust.y-=x*Math.sin(t)/l.FPS):(e.x=this.thrust.x-=X*this.thrust.x/l.FPS,e.y=this.thrust.y-=X*this.thrust.y/l.FPS),this.thrust.x=e.x,this.thrust.y=e.y}}class N{constructor(){}addEvent(t){l.CANVAS.addEventListener("click",(e=>this.click(t,e))),l.CANVAS.addEventListener("contextmenu",(e=>this.click(t,e)))}removeEvent(t){l.CANVAS.removeEventListener("click",(e=>this.click(t,e))),l.CANVAS.removeEventListener("contextmenu",(e=>this.click(t,e)))}click(t,e){e.preventDefault();const i=t.position.getData,a={x:e.offsetX,y:e.offsetY};if(t.updateTargetPosition(a),!t.targetPosition.x||!t.targetPosition.y)return;const s=(n=i.x,o=i.y,r=t.targetPosition.x,h=t.targetPosition.y,Math.atan2(r-n,h-o)-.5*Math.PI);var n,o,r,h;if(t.updateAngle(s),!t.targetPosition.x||!t.targetPosition.y)return;const[d,c]=[t.targetPosition.x-i.x,t.targetPosition.y-i.y],m={x:d/l.FPS,y:c/l.FPS};t.thruster.add(m)}}const Q={level:1,enemies:[],lives:l.LIVES,player:new class{constructor(){this.targetPosition={x:void 0,y:void 0},this.rotate=0,this.blinkNum=0,this.blinkTime=0,this.explodeTime=0,this.position=new b,this.thruster=new G,this.laser=new K,this.action=new N}isBlink(){return this.blinkNum>0}isExploding(){return this.explodeTime>0}addAction(){this.action.addEvent(this)}removeAction(){this.action.removeEvent(this)}die(){this.explodeTime=Math.ceil(C*l.FPS)}init(){this.position.setData({x:l.CANVAS.width/2,y:l.CANVAS.height/2,r:T/2,a:.5*Math.PI}),this.targetPosition={x:void 0,y:void 0},this.blinkNum=Math.ceil(M/S),this.blinkTime=Math.ceil(S*l.FPS),this.explodeTime=0}updateTargetPosition(t){this.targetPosition=t}updatePosition(){const t=this.position.getData;this.position.setData({x:t.x+=this.thruster.currentStatus.x,y:t.y+=this.thruster.currentStatus.y,a:t.a+=this.rotate})}updateBlink(){this.isBlink()&&(this.blinkTime--,0==this.blinkTime&&(this.blinkTime=Math.ceil(S*l.FPS),this.blinkNum--))}updateAngle(t){this.position.setData({a:t})}updateExplodeTime(){this.explodeTime--;this.explodeTime>0||this.init()}manageDraw(){const t=this.blinkNum%2==0,e=this.position.getData;this.isExploding()?((t=>{l.CTX.fillStyle="darkred",l.CTX.beginPath(),l.CTX.arc(t.x,t.y,1.7*t.r,0,2*Math.PI,!1),l.CTX.fill(),l.CTX.fillStyle="red",l.CTX.beginPath(),l.CTX.arc(t.x,t.y,1.4*t.r,0,2*Math.PI,!1),l.CTX.fill(),l.CTX.fillStyle="orange",l.CTX.beginPath(),l.CTX.arc(t.x,t.y,1.1*t.r,0,2*Math.PI,!1),l.CTX.fill(),l.CTX.fillStyle="yellow",l.CTX.beginPath(),l.CTX.arc(t.x,t.y,.8*t.r,0,2*Math.PI,!1),l.CTX.fill(),l.CTX.fillStyle="white",l.CTX.beginPath(),l.CTX.arc(t.x,t.y,.5*t.r,0,2*Math.PI,!1),l.CTX.fill()})(e),this.updateExplodeTime()):t?(((t,e)=>{l.CTX.strokeStyle="white",l.CTX.lineWidth=T/e,l.CTX.beginPath(),l.CTX.moveTo(t.x+4/3*t.r*Math.cos(t.a),t.y-4/3*t.r*Math.sin(t.a)),l.CTX.lineTo(t.x-t.r*(2/3*Math.cos(t.a)+Math.sin(t.a)),t.y+t.r*(2/3*Math.sin(t.a)-Math.cos(t.a))),l.CTX.lineTo(t.x-t.r*(2/3*Math.cos(t.a)-Math.sin(t.a)),t.y+t.r*(2/3*Math.sin(t.a)+Math.cos(t.a))),l.CTX.closePath(),l.CTX.stroke(),l.CTX.fillStyle="darkred",l.CTX.beginPath(),l.CTX.arc(t.x+4/3*t.r*Math.cos(t.a),t.y-4/3*t.r*Math.sin(t.a),.2*t.r,0,2*Math.PI,!1),l.CTX.fill()})(e,20),this.updateBlink()):this.updateBlink()}update(){const t=this.position.getData;this.isExploding()||(this.thruster.update(t.a),this.updatePosition()),this.manageDraw(),this.isBlink()||this.laser.autoShootLaser(t),this.position.handleEdgeOfScreen(),this.laser.updateLasers()}}};const O=new class{constructor(){this.gameState=r({},Q),this.sceneManager=new d,this.gameManager=this,this.debugOptions={},this.sceneManager.init(),this.setupAllScene(),this.init()}reduceLives(){this.gameState.lives--}levelUp(){this.gameState.level++}isGameover(){return this.gameState.lives<=0}isStageClear(){return!this.isGameover()&&!this.gameState.enemies.length}init(){this.initState(),this.sceneManager.use("initGame")}initState(){var t,a;this.gameState=(t=r({},Q),a={enemies:[...Q.enemies]},e(t,i(a)))}debugMethod(){return{god:()=>{this.debugOptions.god=!0},isGod:()=>this.debugOptions.god,killEnemy:()=>{this.gameState.enemies.shift()},killAllEnemy:()=>{this.gameState.enemies=[]}}}updateEnemies(t){this.gameState.enemies=t}setupAllScene(){Object.keys(B).forEach((t=>{this.sceneManager.add(t,(()=>{B[t](this.gameManager,this.sceneManager)}))}))}render(){this.sceneManager.update()}};let W,q,j,J;const H=()=>{requestAnimationFrame(H),q=Date.now(),J=q-j,J>W&&(j=q-J%W,O.render())};var Y;Y=l.FPS,W=1e3/Y,j=Date.now(),H();
